{
    "sourceFile": "src/app/api/vouchers/route.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1740331800764,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1740331953154,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n const pool = new Pool({\r\n   connectionString: process.env.DATABASE_URL,\r\n });\r\n \r\n-export default async function handler(req, res) {\r\n+export async function GET(req) {\r\n   try {\r\n     console.log(\"üì° Buscando vouchers no banco de dados...\");\r\n \r\n     const query = `\r\n@@ -23,10 +23,16 @@\n     const result = await pool.query(query);\r\n     \r\n     console.log(\"üîç Vouchers encontrados:\", result.rows);\r\n \r\n-    res.status(200).json(result.rows);\r\n+    return new Response(JSON.stringify(result.rows), {\r\n+      status: 200,\r\n+      headers: { \"Content-Type\": \"application/json\" },\r\n+    });\r\n   } catch (error) {\r\n     console.error(\"‚ùå Erro ao buscar vouchers:\", error);\r\n-    res.status(500).json({ error: \"Erro interno ao buscar vouchers\" });\r\n+    return new Response(JSON.stringify({ error: \"Erro interno ao buscar vouchers\" }), {\r\n+      status: 500,\r\n+      headers: { \"Content-Type\": \"application/json\" },\r\n+    });\r\n   }\r\n }\r\n"
                }
            ],
            "date": 1740331800764,
            "name": "Commit-0",
            "content": "import { Pool } from \"pg\";\r\n\r\nconst pool = new Pool({\r\n  connectionString: process.env.DATABASE_URL,\r\n});\r\n\r\nexport default async function handler(req, res) {\r\n  try {\r\n    console.log(\"üì° Buscando vouchers no banco de dados...\");\r\n\r\n    const query = `\r\n      SELECT \r\n        v.id AS voucher_id,\r\n        v.codigo AS voucher_codigo,\r\n        v.desconto AS voucher_desconto,\r\n        p.nome_empresa AS parceiro_nome,\r\n        p.nicho AS parceiro_nicho,\r\n        p.foto AS parceiro_foto\r\n      FROM vouchers v\r\n      INNER JOIN parceiros p ON v.parceiro_id = p.id\r\n    `;\r\n\r\n    const result = await pool.query(query);\r\n    \r\n    console.log(\"üîç Vouchers encontrados:\", result.rows);\r\n\r\n    res.status(200).json(result.rows);\r\n  } catch (error) {\r\n    console.error(\"‚ùå Erro ao buscar vouchers:\", error);\r\n    res.status(500).json({ error: \"Erro interno ao buscar vouchers\" });\r\n  }\r\n}\r\n"
        }
    ]
}